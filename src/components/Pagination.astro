---
interface Props {
  currentPage: number;
  lastPage: number;
  baseUrl: string;
}

const { currentPage, lastPage, baseUrl } = Astro.props;

// Generate page numbers to display
function getPageNumbers(current: number, last: number): (number | 'ellipsis')[] {
  const pages: (number | 'ellipsis')[] = [];
  
  if (last <= 7) {
    // Show all pages if 7 or fewer
    for (let i = 1; i <= last; i++) {
      pages.push(i);
    }
  } else {
    // Always show first page
    pages.push(1);
    
    if (current > 3) {
      pages.push('ellipsis');
    }
    
    // Show pages around current
    const start = Math.max(2, current - 1);
    const end = Math.min(last - 1, current + 1);
    
    for (let i = start; i <= end; i++) {
      pages.push(i);
    }
    
    if (current < last - 2) {
      pages.push('ellipsis');
    }
    
    // Always show last page
    pages.push(last);
  }
  
  return pages;
}

const pageNumbers = getPageNumbers(currentPage, lastPage);

function getPageUrl(page: number): string {
  if (page === 1) {
    return baseUrl;
  }
  return `${baseUrl}/${page}`;
}
---

{lastPage > 1 && (
  <nav class="mt-12 flex items-center justify-center gap-2" aria-label="Pagination">
    <!-- Previous button -->
    {currentPage > 1 ? (
      <a
        href={getPageUrl(currentPage - 1)}
        class="inline-flex items-center rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"
        aria-label="Previous page"
      >
        <svg class="mr-1 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Prev
      </a>
    ) : (
      <span class="inline-flex cursor-not-allowed items-center rounded-lg border border-gray-200 bg-gray-100 px-3 py-2 text-sm font-medium text-gray-400 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-600">
        <svg class="mr-1 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Prev
      </span>
    )}

    <!-- Page numbers -->
    <div class="hidden items-center gap-1 sm:flex">
      {pageNumbers.map((page) => (
        page === 'ellipsis' ? (
          <span class="px-2 text-gray-400">â€¦</span>
        ) : page === currentPage ? (
          <span
            class="inline-flex h-10 w-10 items-center justify-center rounded-lg bg-accent text-sm font-medium text-white dark:bg-accent-dark dark:text-gray-900"
            aria-current="page"
          >
            {page}
          </span>
        ) : (
          <a
            href={getPageUrl(page)}
            class="inline-flex h-10 w-10 items-center justify-center rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800"
          >
            {page}
          </a>
        )
      ))}
    </div>

    <!-- Mobile page indicator -->
    <span class="text-sm text-gray-600 dark:text-gray-400 sm:hidden">
      Page {currentPage} of {lastPage}
    </span>

    <!-- Next button -->
    {currentPage < lastPage ? (
      <a
        href={getPageUrl(currentPage + 1)}
        class="inline-flex items-center rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"
        aria-label="Next page"
      >
        Next
        <svg class="ml-1 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </a>
    ) : (
      <span class="inline-flex cursor-not-allowed items-center rounded-lg border border-gray-200 bg-gray-100 px-3 py-2 text-sm font-medium text-gray-400 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-600">
        Next
        <svg class="ml-1 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </span>
    )}
  </nav>
)}

